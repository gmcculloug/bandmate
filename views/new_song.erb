<h2>➕ Add New Song</h2>

<% if defined?(@errors) && @errors.any? %>
    <div class="errors">
        <ul>
            <% @errors.each do |error| %>
                <li><%= error %></li>
            <% end %>
        </ul>
    </div>
<% end %>

<form method="POST" action="/songs" class="card">
    <div class="form-group">
        <label for="song_title">Title *</label>
        <input type="text" id="song_title" name="song[title]" required autofocus>
    </div>

    <div class="form-group">
        <label for="song_artist">Artist *</label>
        <input type="text" id="song_artist" name="song[artist]" required>
    </div>

    <div style="margin-bottom: 20px; padding: 15px; background: #e6fffa; border-radius: 8px; border-left: 4px solid #38a169;">
        <p style="margin: 0; color: #2f855a; font-weight: 500;">
            ℹ️ Songs are added to the song catalog first, then bands can copy them to their repertoires from the Song Catalog page.
        </p>
    </div>

    <div style="display: grid; grid-template-columns: 1fr; gap: 20px;">
        <style>
            @media (min-width: 768px) {
                .form-grid {
                    grid-template-columns: 1fr 1fr !important;
                }
            }
        </style>
        <div class="form-grid" style="display: grid; grid-template-columns: 1fr; gap: 20px;">
            <div class="form-group">
                <label for="song_key">Key *</label>
                <select id="song_key" name="song[key]" required>
                    <option value="">Select Key</option>
                    <option value="C">C</option>
                    <option value="C#/Db">C#/Db</option>
                    <option value="D">D</option>
                    <option value="D#/Eb">D#/Eb</option>
                    <option value="E">E</option>
                    <option value="F">F</option>
                    <option value="F#/Gb">F#/Gb</option>
                    <option value="G">G</option>
                    <option value="G#/Ab">G#/Ab</option>
                    <option value="A">A</option>
                    <option value="A#/Bb">A#/Bb</option>
                    <option value="B">B</option>
                </select>
            </div>

            <div class="form-group">
                <label for="song_original_key">Original Key</label>
                <select id="song_original_key" name="song[original_key]">
                    <option value="">Select Original Key</option>
                    <option value="C">C</option>
                    <option value="C#/Db">C#/Db</option>
                    <option value="D">D</option>
                    <option value="D#/Eb">D#/Eb</option>
                    <option value="E">E</option>
                    <option value="F">F</option>
                    <option value="F#/Gb">F#/Gb</option>
                    <option value="G">G</option>
                    <option value="G#/Ab">G#/Ab</option>
                    <option value="A">A</option>
                    <option value="A#/Bb">A#/Bb</option>
                    <option value="B">B</option>
                </select>
            </div>
        </div>
    </div>

    <div style="display: grid; grid-template-columns: 1fr; gap: 20px;">
        <div class="form-grid" style="display: grid; grid-template-columns: 1fr; gap: 20px;">
            <div class="form-group">
                <label for="song_tempo">Tempo (BPM)</label>
                <input type="number" id="song_tempo" name="song[tempo]" min="1" max="300">
            </div>

            <div class="form-group">
                <label for="song_genre">Genre</label>
                <input type="text" id="song_genre" name="song[genre]" placeholder="e.g., Rock, Jazz, Pop">
            </div>
        </div>
    </div>

    <div style="display: grid; grid-template-columns: 1fr; gap: 20px;">
        <div class="form-grid" style="display: grid; grid-template-columns: 1fr; gap: 20px;">
            <div class="form-group">
                <label for="song_duration">Duration *</label>
                <input type="text" id="song_duration" name="song[duration]" placeholder="e.g., 3:45" required>
            </div>

            <div class="form-group">
                <label for="song_year">Year</label>
                <input type="number" id="song_year" name="song[year]" min="1900" max="2030" placeholder="e.g., 2020">
            </div>
        </div>
    </div>

    <div class="form-group">
        <label for="song_album">Album</label>
        <input type="text" id="song_album" name="song[album]" placeholder="Album name">
    </div>

    <div class="form-group">
        <label for="song_url">Streaming URL</label>
        <input type="url" id="song_url" name="song[url]" placeholder="https://www.youtube.com/watch?v=... or Spotify/Apple Music link">
    </div>

    <div class="form-group">
        <label for="song_notes">Notes</label>
        <textarea id="song_notes" name="song[notes]" rows="4" placeholder="Any additional notes about the song, chords, etc."></textarea>
    </div>

    <div class="form-group">
        <label for="song_lyrics">Lyrics</label>
        <textarea id="song_lyrics" name="song[lyrics]" rows="8" placeholder="Song lyrics..."></textarea>
    </div>

    <div class="actions">
        <button type="submit" class="btn btn-success">Save Song</button>
        <a href="/songs" class="btn">Cancel</a>
    </div>
</form>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const keySelect = document.getElementById('song_key');
    const originalKeySelect = document.getElementById('song_original_key');
    
    keySelect.addEventListener('change', function() {
        // Only set original key if it hasn't been set yet (is empty)
        if (originalKeySelect.value === '') {
            originalKeySelect.value = this.value;
        }
    });
});
</script> 